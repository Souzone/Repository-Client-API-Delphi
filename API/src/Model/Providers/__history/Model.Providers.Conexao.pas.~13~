unit Model.Providers.Conexao;

interface

uses
  Model.Interfaces,
  FireDAC.Stan.Intf,
  FireDAC.Stan.Option,
  FireDAC.Stan.Param,
  FireDAC.Stan.Error,
  FireDAC.DatS,
  FireDAC.Phys.Intf,
  FireDAC.DApt.Intf,
  FireDAC.Stan.Async,
  FireDAC.DApt,
  Data.DB,
  FireDAC.Comp.DataSet,
  FireDAC.Comp.Client;

type
  TModelProvidersConexao = class(TInterfacedObject, IModelProviders)
  private
    FdQuery: TFdquery;
    FDConnection: TFDConnection;
    procedure ConfigConection;
  public
    constructor create;
    destructor destroy; override;
    Class Function New: IModelProviders;
    function FdConexao: TFdquery;
  end;

implementation

{ TModelProvidersConexao }

procedure TModelProvidersConexao.ConfigConection;
begin
  FDConnection.DriverName :='SQLite';
  FDConnection.Params.Database := 'D:\Cursos\Academia do Código Delphi Senior\Arquitetura 3 camadas\api\fddemo.sdb';
  FDConnection.Connected := true;
  FdQuery.Connection :=FDConnection;
end;

constructor TModelProvidersConexao.create;
begin
  FDConnection.Create(nil);
  FdQuery.Create(nil);
  ConfigConection;
end;

destructor TModelProvidersConexao.destroy;
begin
  FDConnection.DisposeOf;
  FdQuery.DisposeOf;
  inherited;
end;

function TModelProvidersConexao.FdConexao: TFdquery;
begin
  Result:= FdQuery;
end;

class function TModelProvidersConexao.New: IModelProviders;
begin
  result := self.create;
end;

end.
